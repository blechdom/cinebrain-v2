{"version":3,"sources":["webpack:///./server/server.js?268d"],"names":["app","use","static","json","db","get","req","res","filter","query","status","effort_lte","effort_gte","effort","$lte","parseInt","$gte","collection","find","toArray","then","issues","metadata","total_count","length","_metadata","records","catch","error","console","log","message","devices","device_1_casparcg","dmx_presets","post","newIssue","body","created","Date","err","validateIssue","insertOne","cleanupIssue","result","_id","insertedId","limit","next","savedIssue","newDevice","validateDevice","cleanupDevice","savedDevice","newDMXPreset","validateDMXPreset","savedDMXPreset","issueId","params","id","issue","deviceId","device","put","updateOne","convertIssue","convertDevice","delete","deleteOne","deleteResult","n","setDb","newDb","dmx_preset","errors","Object","keys","dmx_presetFieldType","forEach","field","push","validDMXPresetStatus","join"],"mappings":"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","file":"0.478e651afa7cd33d053b.hot-update.js","sourcesContent":["import express from 'express';\r\nimport bodyParser from 'body-parser';\r\nimport { ObjectId } from 'mongodb';\r\nimport Issue from './issue.js';\r\nimport Device from './device.js';\r\nimport renderedPageRouter from './renderedPageRouter.jsx';\r\n\r\nconst app = express();\r\n\r\napp.use(express.static('static'));\r\napp.use(bodyParser.json());\r\n\r\nlet db;\r\n\r\napp.get('/api/issues', (req, res) => {\r\n  const filter = {};\r\n  if (req.query.status) filter.status = req.query.status;\r\n  if (req.query.effort_lte || req.query.effort_gte) filter.effort = {};\r\n  if (req.query.effort_lte) filter.effort.$lte = parseInt(req.query.effort_lte, 10);\r\n  if (req.query.effort_gte) filter.effort.$gte = parseInt(req.query.effort_gte, 10);\r\n\r\n  db.collection('issues').find(filter).toArray()\r\n  .then(issues => {\r\n    const metadata = { total_count: issues.length };\r\n    res.json({ _metadata: metadata, records: issues });\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\n\r\napp.get('/api/devices', (req, res) => {\r\n  const filter = {};\r\n  if (req.query.status) filter.status = req.query.status;\r\n  if (req.query.effort_lte || req.query.effort_gte) filter.effort = {};\r\n  if (req.query.effort_lte) filter.effort.$lte = parseInt(req.query.effort_lte, 10);\r\n  if (req.query.effort_gte) filter.effort.$gte = parseInt(req.query.effort_gte, 10);\r\n\r\n  db.collection('devices').find(filter).toArray()\r\n  .then(devices => {\r\n    const metadata = { total_count: devices.length };\r\n    res.json({ _metadata: metadata, records: devices });\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\n\r\napp.get('/api/device_1_casparcg', (req, res) => {\r\n  const filter = {};\r\n  if (req.query.status) filter.status = req.query.status;\r\n  if (req.query.effort_lte || req.query.effort_gte) filter.effort = {};\r\n  if (req.query.effort_lte) filter.effort.$lte = parseInt(req.query.effort_lte, 10);\r\n  if (req.query.effort_gte) filter.effort.$gte = parseInt(req.query.effort_gte, 10);\r\n\r\n  db.collection('device_1_casparcg').find(filter).toArray()\r\n  .then(device_1_casparcg => {\r\n    const metadata = { total_count: device_1_casparcg.length };\r\n    res.json({ _metadata: metadata, records: device_1_casparcg });\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\n\r\napp.get('/api/dmx_presets', (req, res) => {\r\n  const filter = {};\r\n  if (req.query.status) filter.status = req.query.status;\r\n  if (req.query.effort_lte || req.query.effort_gte) filter.effort = {};\r\n  if (req.query.effort_lte) filter.effort.$lte = parseInt(req.query.effort_lte, 10);\r\n  if (req.query.effort_gte) filter.effort.$gte = parseInt(req.query.effort_gte, 10);\r\n\r\n  db.collection('dmx_presets').find(filter).toArray()\r\n  .then(dmx_presets => {\r\n    const metadata = { total_count: dmx_presets.length };\r\n    res.json({ _metadata: metadata, records: dmx_presets });\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\n\r\napp.post('/api/issues', (req, res) => {\r\n  const newIssue = req.body;\r\n  newIssue.created = new Date();\r\n  if (!newIssue.status) {\r\n    newIssue.status = 'New';\r\n  }\r\n\r\n  const err = Issue.validateIssue(newIssue);\r\n  if (err) {\r\n    res.status(422).json({ message: `Invalid request: ${err}` });\r\n    return;\r\n  }\r\n\r\n  db.collection('issues').insertOne(Issue.cleanupIssue(newIssue)).then(result =>\r\n    db.collection('issues').find({ _id: result.insertedId }).limit(1)\r\n    .next()\r\n  )\r\n  .then(savedIssue => {\r\n    res.json(savedIssue);\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\n\r\napp.post('/api/devices', (req, res) => {\r\n  const newDevice = req.body;\r\n  newDevice.created = new Date();\r\n  if (!newDevice.status) {\r\n    newDevice.status = 'New';\r\n  }\r\n\r\n  const err = Device.validateDevice(newDevice);\r\n  if (err) {\r\n    res.status(422).json({ message: `Invalid request: ${err}` });\r\n    return;\r\n  }\r\n\r\n  db.collection('devices').insertOne(Device.cleanupDevice(newDevice)).then(result =>\r\n    db.collection('devices').find({ _id: result.insertedId }).limit(1)\r\n    .next()\r\n  )\r\n  .then(savedDevice => {\r\n    res.json(savedDevice);\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\n\r\napp.post('/api/dmx_presets', (req, res) => {\r\n  const newDMXPreset = req.body;\r\n  newDMXPreset.created = new Date();\r\n  if (!newDMXPreset.status) {\r\n    newDMXPreset.status = 'New';\r\n  }\r\n\r\n  const err = validateDMXPreset(newDMXPreset);\r\n  if (err) {\r\n    res.status(422).json({ message: `Invalid request: ${err}` });\r\n    return;\r\n  }\r\n\r\n  db.collection('dmx_presets').insertOne(newDMXPreset).then(result =>\r\n    db.collection('dmx_presets').find({ _id: result.insertedId }).limit(1)\r\n    .next()\r\n  )\r\n  .then(savedDMXPreset => {\r\n    res.json(savedDMXPreset);\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\n\r\napp.get('/api/issues/:id', (req, res) => {\r\n  let issueId;\r\n  try {\r\n    issueId = new ObjectId(req.params.id);\r\n  } catch (error) {\r\n    res.status(422).json({ message: `Invalid issue ID format: ${error}` });\r\n    return;\r\n  }\r\n\r\n  db.collection('issues').find({ _id: issueId }).limit(1)\r\n  .next()\r\n  .then(issue => {\r\n    if (!issue) res.status(404).json({ message: `No such issue: ${issueId}` });\r\n    else res.json(issue);\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\n\r\napp.get('/api/devices/:id', (req, res) => {\r\n  let deviceId;\r\n  try {\r\n    deviceId = new ObjectId(req.params.id);\r\n  } catch (error) {\r\n    res.status(422).json({ message: `Invalid device ID format: ${error}` });\r\n    return;\r\n  }\r\n\r\n  db.collection('devices').find({ _id: deviceId }).limit(1)\r\n  .next()\r\n  .then(device => {\r\n    if (!device) res.status(404).json({ message: `No such device: ${deviceId}` });\r\n    else res.json(device);\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\n\r\napp.put('/api/issues/:id', (req, res) => {\r\n  let issueId;\r\n  try {\r\n    issueId = new ObjectId(req.params.id);\r\n  } catch (error) {\r\n    res.status(422).json({ message: `Invalid issue ID format: ${error}` });\r\n    return;\r\n  }\r\n\r\n  const issue = req.body;\r\n  delete issue._id;\r\n\r\n  const err = Issue.validateIssue(issue);\r\n  if (err) {\r\n    res.status(422).json({ message: `Invalid request: ${err}` });\r\n    return;\r\n  }\r\n\r\n  db.collection('issues').updateOne({ _id: issueId }, Issue.convertIssue(issue)).then(() =>\r\n    db.collection('issues').find({ _id: issueId }).limit(1)\r\n    .next()\r\n  )\r\n  .then(savedIssue => {\r\n    res.json(savedIssue);\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\n\r\napp.put('/api/devices/:id', (req, res) => {\r\n  let deviceId;\r\n  try {\r\n    deviceId = new ObjectId(req.params.id);\r\n  } catch (error) {\r\n    res.status(422).json({ message: `Invalid device ID format: ${error}` });\r\n    return;\r\n  }\r\n\r\n  const device = req.body;\r\n  delete device._id;\r\n\r\n  const err = Device.validateDevice(device);\r\n  if (err) {\r\n    res.status(422).json({ message: `Invalid request: ${err}` });\r\n    return;\r\n  }\r\n\r\n  db.collection('devices').updateOne({ _id: deviceId }, Device.convertDevice(device)).then(() =>\r\n    db.collection('devices').find({ _id: deviceId }).limit(1)\r\n    .next()\r\n  )\r\n  .then(savedDevice => {\r\n    res.json(savedDevice);\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\napp.delete('/api/issues/:id', (req, res) => {\r\n  let issueId;\r\n  try {\r\n    issueId = new ObjectId(req.params.id);\r\n  } catch (error) {\r\n    res.status(422).json({ message: `Invalid issue ID format: ${error}` });\r\n    return;\r\n  }\r\n\r\n  db.collection('issues').deleteOne({ _id: issueId }).then((deleteResult) => {\r\n    if (deleteResult.result.n === 1) res.json({ status: 'OK' });\r\n    else res.json({ status: 'Warning: object not found' });\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\napp.delete('/api/devices/:id', (req, res) => {\r\n  let deviceId;\r\n  try {\r\n    deviceId = new ObjectId(req.params.id);\r\n  } catch (error) {\r\n    res.status(422).json({ message: `Invalid device ID format: ${error}` });\r\n    return;\r\n  }\r\n\r\n  db.collection('devices').deleteOne({ _id: deviceId }).then((deleteResult) => {\r\n    if (deleteResult.result.n === 1) res.json({ status: 'OK' });\r\n    else res.json({ status: 'Warning: object not found' });\r\n  })\r\n  .catch(error => {\r\n    console.log(error);\r\n    res.status(500).json({ message: `Internal Server Error: ${error}` });\r\n  });\r\n});\r\n\r\napp.use('/', renderedPageRouter);\r\n\r\nfunction setDb(newDb) {\r\n  db = newDb;\r\n}\r\n\r\nfunction validateDMXPreset(dmx_preset) {\r\n  const errors = [];\r\n  Object.keys(dmx_presetFieldType).forEach(field => {\r\n    if (dmx_presetFieldType[field] === 'required' && !dmx_preset[field]) {\r\n      errors.push(`Missing mandatory field: ${field}`);\r\n    }\r\n  });\r\n\r\n  if (!validDMXPresetStatus[dmx_preset.status]) {\r\n    errors.push(`${dmx_preset.status} is not a valid status.`);\r\n  }\r\n\r\n  return (errors.length ? errors.join('; ') : null);\r\n}\r\n\r\nexport { app, setDb };\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/server.js"],"sourceRoot":""}
{"version":3,"sources":["webpack:///./server/drivers/enttec-usb-dmx-pro.js?ac44"],"names":["SerialPort","require","console","log","ENTTEC_PRO_DMX_STARTCODE","ENTTEC_PRO_START_OF_MSG","ENTTEC_PRO_END_OF_MSG","ENTTEC_PRO_SEND_DMX_RQ","ENTTEC_PRO_RECV_DMX_PKT","EnttecUSBDMXPRO","device_id","options","self","universe","Buffer","dev","err","JSON","stringify","prototype","send_universe","isOpen","hdr","length","msg","concat","write","start","stop","close","cb","update","u","c","updateAll","v","i","get","module","exports"],"mappings":"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","file":"0.68286f7f5d9de6575817.hot-update.js","sourcesContent":["\"use strict\"\r\n\r\nvar SerialPort = require(\"serialport\")\r\nconsole.log(\"enttec driver loaded\");\r\n\r\nvar\t  ENTTEC_PRO_DMX_STARTCODE = 0x00\r\n\t, ENTTEC_PRO_START_OF_MSG  = 0x7e\r\n\t, ENTTEC_PRO_END_OF_MSG    = 0xe7\r\n\t, ENTTEC_PRO_SEND_DMX_RQ   = 0x06\r\n\t, ENTTEC_PRO_RECV_DMX_PKT  = 0x05\r\n\t;\r\n\r\nfunction EnttecUSBDMXPRO(device_id, options) {\r\n\tvar self = this\r\n\toptions = options || {}\r\n\tthis.universe = new Buffer(512)\r\n\t\r\n\tthis.dev = new SerialPort(device_id, {\r\n\t\t'baudrate': 250000,\r\n\t\t'databits': 8,\r\n\t\t'stopbits': 2,\r\n\t\t'parity': 'none'\r\n\t}, function(err) {\r\n\t\tconsole.log(\"dmx enttec driver device error\");\r\n\t})\r\n\tconsole.log(\"in driver: this.dev: \" + JSON.stringify(this.dev));\r\n}\r\n\r\nEnttecUSBDMXPRO.prototype.send_universe = function() {\r\n\tif(!this.dev.isOpen()) {\r\n\t\tconsole.log(\"in driver, this.dev is NOT open\");\r\n\t\treturn\r\n\t}\r\n\tvar hdr = Buffer([\r\n\t\tENTTEC_PRO_START_OF_MSG,\r\n\t\tENTTEC_PRO_SEND_DMX_RQ,\r\n\t\t (this.universe.length + 1)       & 0xff,\r\n\t\t((this.universe.length + 1) >> 8) & 0xff,\r\n\t\tENTTEC_PRO_DMX_STARTCODE\r\n\t])\r\n\tconsole.log(\"in driver hdr: \" + JSON.stringify(hdr));\r\n\tvar msg = Buffer.concat([\r\n\t\thdr,\r\n\t\tthis.universe,\r\n\t\tBuffer([ENTTEC_PRO_END_OF_MSG])\r\n\t])\r\n\tconsole.log(\"in driver message: \" + JSON.stringify(msg));\r\n\tthis.dev.write(msg)\r\n}\r\n\r\nEnttecUSBDMXPRO.prototype.start = function() {console.log(\"in driver, start\");}\r\nEnttecUSBDMXPRO.prototype.stop = function() {console.log(\"in driver, stop\");}\r\n\r\nEnttecUSBDMXPRO.prototype.close = function(cb) {\r\n\tthis.dev.close(cb)\r\n\tconsole.log(\"in driver, close dev\");\r\n}\r\n\r\nEnttecUSBDMXPRO.prototype.update = function(u) {\r\n\tconsole.log(\"in enttec update what is u: \" + JSON.stringify(u));\r\n\tfor(var c in u) {\r\n\t\tthis.universe[c] = u[c]\r\n\t\tconsole.log(\"c: \" + c + \" u: \" + JSON.stringify(u));\r\n\t}\r\n\tconsole.log(\"update enttec this.universe: \" + JSON.stringify(this.universe));\r\n\tthis.send_universe()\r\n}\r\n\r\nEnttecUSBDMXPRO.prototype.updateAll = function(v){\r\n\tfor(var i = 0; i < 512; i++) {\r\n\t\tthis.universe[i] = v\r\n\t}\r\n\tthis.send_universe()\r\n}\r\n\r\nEnttecUSBDMXPRO.prototype.get = function(c) {\r\n\treturn this.universe[c]\r\n}\r\n\r\nmodule.exports = EnttecUSBDMXPRO\n\n\n// WEBPACK FOOTER //\n// ./server/drivers/enttec-usb-dmx-pro.js"],"sourceRoot":""}
{"version":3,"sources":["webpack:///./server/dmx_usb_pro.js?20e1","webpack:///./server/drivers/enttec-usb-dmx-pro.js?ac44"],"names":["util","require","EventEmitter","SerialPort","dmx_usb_pro","console","log","DMX","device_id","universe","inherits","prototype","update","channels","emit","updateAll","value","universeToObject","u","i","length","get","module","exports","ENTTEC_PRO_DMX_STARTCODE","ENTTEC_PRO_START_OF_MSG","ENTTEC_PRO_END_OF_MSG","ENTTEC_PRO_SEND_DMX_RQ","ENTTEC_PRO_RECV_DMX_PKT","EnttecUSBDMXPRO","options","self","Buffer","dev","err","JSON","stringify","send_universe","isOpen","hdr","msg","concat","write","start","stop","close","cb","c","v"],"mappings":"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","file":"0.f90bf6948559eadcc6f0.hot-update.js","sourcesContent":["\"use strict\"\r\n\r\nvar util = require('util')\r\nvar EventEmitter = require('events').EventEmitter;\r\nvar SerialPort = require(\"serialport\")\r\nvar dmx_usb_pro = require('./drivers/enttec-usb-dmx-pro');\r\nconsole.log(\"dmx usb pro library loaded\");\r\n\r\nfunction DMX(device_id) {\r\n\tconsole.log(\"initalize dmx usb pro\");\r\n\tthis.universe = {};\r\n\treturn this.universe = new dmx_usb_pro(device_id)\r\n\t//this.universe = {};\r\n}\r\n\r\nutil.inherits(DMX, EventEmitter)\r\n\r\n\r\n/*DMX.prototype.initializeDMXUSBPRO = function(device_id) {\r\n\tconsole.log(\"initalize dmx usb pro\");\r\n\treturn this.universe = new dmx_usb_pro(device_id)\r\n}\r\n*/\r\nDMX.prototype.update = function(universe, channels) {\r\n\tconsole.log(\"update universe to be \" + universe + \" and channels are \" + channels);\r\n\tthis.universe.update(channels)\r\n\tthis.emit('update', universe, channels)\r\n}\r\n\r\nDMX.prototype.updateAll = function(universe, value) {\r\n\tthis.universe.updateAll(value)\r\n\tthis.emit('updateAll', universe, value)\r\n}\r\n\r\nDMX.prototype.universeToObject = function(universe) {\r\n\t//var universe = this.universe\r\n\tvar u = {}\r\n\tfor(var i = 0; i < this.universe.length; i++) {\r\n\t\tu[i] = this.universe.get(i)\r\n\t}\r\n\treturn u\r\n}\r\n\r\nmodule.exports = DMX\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/dmx_usb_pro.js","\"use strict\"\r\n\r\nvar SerialPort = require(\"serialport\")\r\nconsole.log(\"enttec driver loaded\");\r\n\r\nvar\t  ENTTEC_PRO_DMX_STARTCODE = 0x00\r\n\t, ENTTEC_PRO_START_OF_MSG  = 0x7e\r\n\t, ENTTEC_PRO_END_OF_MSG    = 0xe7\r\n\t, ENTTEC_PRO_SEND_DMX_RQ   = 0x06\r\n\t, ENTTEC_PRO_RECV_DMX_PKT  = 0x05\r\n\t;\r\n\r\nfunction EnttecUSBDMXPRO(device_id, options) {\r\n\tvar self = this\r\n\toptions = options || {}\r\n\tthis.universe = new Buffer(512)\r\n\t\r\n\tthis.dev = new SerialPort(device_id, {\r\n\t\t'baudrate': 250000,\r\n\t\t'databits': 8,\r\n\t\t'stopbits': 2,\r\n\t\t'parity': 'none'\r\n\t}, function(err) {\r\n\t\tconsole.log(\"dmx enttec driver device error\");\r\n\t})\r\n\tconsole.log(\"in driver: this.dev: \" + JSON.stringify(this.dev));\r\n}\r\n\r\nEnttecUSBDMXPRO.prototype.send_universe = function() {\r\n\tif(!this.dev.isOpen()) {\r\n\t\tconsole.log(\"in driver, this.dev is NOT open\");\r\n\t\treturn\r\n\t}\r\n\tvar hdr = Buffer([\r\n\t\tENTTEC_PRO_START_OF_MSG,\r\n\t\tENTTEC_PRO_SEND_DMX_RQ,\r\n\t\t (this.universe.length + 1)       & 0xff,\r\n\t\t((this.universe.length + 1) >> 8) & 0xff,\r\n\t\tENTTEC_PRO_DMX_STARTCODE\r\n\t])\r\n\tconsole.log(\"in driver hdr: \" + JSON.stringify(hdr));\r\n\tvar msg = Buffer.concat([\r\n\t\thdr,\r\n\t\tthis.universe,\r\n\t\tBuffer([ENTTEC_PRO_END_OF_MSG])\r\n\t])\r\n\tconsole.log(\"in driver message: \" + JSON.stringify(msg));\r\n\tthis.dev.write(msg)\r\n}\r\n\r\nEnttecUSBDMXPRO.prototype.start = function() {console.log(\"in driver, start\");}\r\nEnttecUSBDMXPRO.prototype.stop = function() {console.log(\"in driver, stop\");}\r\n\r\nEnttecUSBDMXPRO.prototype.close = function(cb) {\r\n\tthis.dev.close(cb)\r\n\tconsole.log(\"in driver, close dev\");\r\n}\r\n\r\nEnttecUSBDMXPRO.prototype.update = function(u) {\r\n\tconsole.log(\"in enttec update what is u: \" + JSON.stringify(u));\r\n\tfor(var c in u) {\r\n\t\tthis.universe[c] = u[c]\r\n\t\tconsole.log(\"c: \" + c + \" u: \" + JSON.stringify(u));\r\n\t}\r\n\tconsole.log(\"update enttec this.universe: \" + JSON.stringify(this.universe));\r\n\tthis.send_universe()\r\n}\r\n\r\nEnttecUSBDMXPRO.prototype.updateAll = function(v){\r\n\tfor(var i = 0; i < 512; i++) {\r\n\t\tthis.universe[i] = v\r\n\t}\r\n\tthis.send_universe()\r\n}\r\n\r\nEnttecUSBDMXPRO.prototype.get = function(c) {\r\n\treturn this.universe[c]\r\n}\r\n\r\nmodule.exports = EnttecUSBDMXPRO\n\n\n// WEBPACK FOOTER //\n// ./server/drivers/enttec-usb-dmx-pro.js"],"sourceRoot":""}